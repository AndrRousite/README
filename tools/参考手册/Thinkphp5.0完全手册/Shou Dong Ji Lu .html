<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
  <head>
    <title>日志写入</title>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
        <h1 class="book-title" id="calibre_toc_154">日志写入</h1>
<div class="book-content">
    <h2 id="%E6%97%A5%E5%BF%97%E5%86%99%E5%85%A5" class="calibre15">日志写入</h2>
<table class="calibre25"><thead class="calibre26"><tr class="calibre27"><th class="calibre28">版本</th>
<th class="calibre28">新增功能</th>
</tr></thead><tbody class="calibre29"><tr class="calibre27"><td class="pcalibre1 calibre30">5.0.4</td>
<td class="calibre32 pcalibre1">命令行模式下日志自动定时写入</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">5.0.4</td>
<td class="calibre33 pcalibre1"><code class="calibre7">debug</code>日志类型仅用于调试模式记录</td>
</tr></tbody></table><h3 id="%E6%89%8B%E5%8A%A8%E8%AE%B0%E5%BD%95" class="calibre17">手动记录</h3>
<p class="calibre10">一般情况下，系统的日志记录是自动的，无需手动记录，但是某些时候也需要手动记录日志信息，Log类提供了3个方法用于记录日志。</p>
<table class="calibre25"><thead class="calibre26"><tr class="calibre27"><th class="calibre28">方法</th>
<th class="calibre28">描述</th>
</tr></thead><tbody class="calibre29"><tr class="calibre27"><td class="pcalibre1 calibre30">Log::record()</td>
<td class="calibre32 pcalibre1">记录日志信息到内存</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">Log::save()</td>
<td class="pcalibre1 calibre31">把保存在内存中的日志信息（用指定的记录方式）写入</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">Log::write()</td>
<td class="calibre33 pcalibre1">实时写入一条日志信息</td>
</tr></tbody></table><p class="calibre10">由于系统在请求结束后会自动调用<code class="calibre7">Log::save</code>方法，所以通常，你只需要调用<code class="calibre7">Log::record</code>记录日志信息即可。</p>
<p class="calibre10">record方法用法如下：</p>
<pre class="calibre21"><code class="calibre22">Log::record('测试日志信息');</code></pre>
<p class="calibre10">默认的话记录的日志级别是INFO，也可以指定日志级别：</p>
<pre class="calibre21"><code class="calibre22">Log::record('测试日志信息，这是警告级别','notice');</code></pre>
<p class="calibre10">采用record方法记录的日志信息不是实时保存的，如果需要实时记录的话，可以采用write方法，例如：</p>
<pre class="calibre21"><code class="calibre22">Log::write('测试日志信息，这是警告级别，并且实时写入','notice');</code></pre>
<blockquote class="calibre5">
<p class="calibre14">V5.0.4+版本开始，为避免内容溢出，在命令行下面执行的话 日志信息会定时自动写入。</p>
</blockquote>
<h3 id="%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB" class="calibre17">日志级别</h3>
<p class="calibre10">ThinkPHP对系统的日志按照级别来分类，并且这个日志级别完全可以自己定义，系统内部使用的级别包括：</p>
<ul class="calibre23"><li class="calibre20"><strong class="calibre12">log</strong> 常规日志，用于记录日志</li>
<li class="calibre20"><strong class="calibre12">error</strong> 错误，一般会导致程序的终止</li>
<li class="calibre20"><strong class="calibre12">notice</strong> 警告，程序可以运行但是还不够完美的错误</li>
<li class="calibre20"><strong class="calibre12">info</strong> 信息，程序输出信息</li>
<li class="calibre20"><strong class="calibre12">debug</strong> 调试，用于调试信息</li>
<li class="calibre20"><strong class="calibre12">sql</strong> SQL语句，用于SQL记录，只在数据库的调试模式开启时有效</li>
</ul><p class="calibre10">系统提供了不同日志级别的快速记录方法，例如：</p>
<pre class="calibre21"><code class="calibre22">Log::error('错误信息');
Log::info('日志信息');
// 和下面的用法等效
Log::record('错误信息','error');
Log::record('日志信息','info');</code></pre>
<p class="calibre10">还封装了一个助手函数用于日志记录，例如：</p>
<pre class="calibre21"><code class="calibre22">trace('错误信息','error');
trace('日志信息','info');</code></pre>
<p class="calibre10">也支持指定级别日志的输入，需要配置信息：</p>
<pre class="calibre21"><code class="calibre22">'log'   =&gt; [
    'type'  =&gt; 'File',
    // 日志记录级别，使用数组表示
    'level' =&gt; ['error'],
],</code></pre>
</div>
	
</body></html>
