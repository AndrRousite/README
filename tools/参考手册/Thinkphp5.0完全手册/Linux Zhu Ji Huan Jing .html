<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
  <head>
    <title>Linux 主机环境</title>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
        <h1 class="book-title" id="calibre_toc_217">Linux 主机环境</h1>
<div class="book-content">
    <blockquote class="calibre5">
<p class="calibre14">部分 Linux 主机设置了 open_basedir（可将用户访问文件的活动范围限制在指定的区域，通常是入口文件根目录的路径） 选项，导致 ThinkPHP5 访问白屏或者报错</p>
</blockquote>
<p class="calibre10">如果把<code class="calibre7">ThinkPHP5</code>部署在了<code class="calibre7">LAMP/LNMP</code>环境上很有可能出现白屏的情况，这个时候需要开启 php 错误提示来判断是否是因为设置了<code class="calibre7">open_basedir</code>选项出错。</p>
<p class="calibre10">打开 php.ini 搜索 <code class="calibre7">display_errors</code>，把 Off 修改为 On就开启了 php 错误提示，这时再访问之前白屏的页面就会出现错误信息。如果错误信息如下那么很有可能就是因为<code class="calibre7">open_basedir</code>的问题。<br class="calibre16"/><img src="56ef61c30154e.jpg" alt="" class="calibre11"/></p>
<h2 id="php.ini+%E4%BF%AE%E6%94%B9%E6%96%B9%E6%B3%95" class="calibre15">php.ini 修改方法</h2>
<p class="calibre10">把权限作用域由入口文件目录修改为框架根目录</p>
<p class="calibre10">打开 php.ini 搜索 <code class="calibre7">open_basedir</code>,把</p>
<pre class="calibre21"><code class="calibre22">open_basedir = "/home/wwwroot/tp5/public/:/tmp/:/var/tmp/:/proc/"</code></pre>
<p class="calibre10">修改为</p>
<pre class="calibre21"><code class="calibre22">open_basedir = "/home/wwwroot/tp5/:/tmp/:/var/tmp/:/proc/"</code></pre>
<p class="calibre10">如果你的 <code class="calibre7">php.ini</code> 文件的 <code class="calibre7">open_basedir</code> 设置选项是被注释的或者为 none，那么你需要通过 Apache 或者 Nginx 来修改</p>
<blockquote class="calibre5">
<p class="calibre14">php.ini 文件通常是在 /usr/local/php/etc 目录中，当然了这取决于你 LAMP 环境配置</p>
</blockquote>
<h2 id="apache+%E4%BF%AE%E6%94%B9%E6%96%B9%E6%B3%95" class="calibre15">Apache 修改方法</h2>
<p class="calibre10">Apache 需要修改 <code class="calibre7">httpd.conf</code> 或者同目录下的 <code class="calibre7">vhost</code> 目录下 <code class="calibre7">你的域名.conf</code> 文件，如果你的生成环境是 LAMP 一键安装包配置那么多半就是直接修改 <code class="calibre7">你的域名.conf</code> 文件</p>
<pre class="calibre21"><code class="calibre22">apache
├─vhost
    ├─www.thinkphp.cn.conf
    ├─......
├─httpd.conf</code></pre>
<p class="calibre10">打开 你的域名.conf 文件 搜索 <code class="calibre7">open_basedir</code>,把</p>
<pre class="calibre21"><code class="calibre22">php_admin_value open_basedir "/home/wwwroot/www.thinkphp.cn/public/:/tmp/:/var/tmp/:/proc/"</code></pre>
<p class="calibre10">修改为</p>
<pre class="calibre21"><code class="calibre22">php_admin_value open_basedir "/home/wwwroot/www.thinkphp.cn/:/tmp/:/var/tmp/:/proc/"</code></pre>
<p class="calibre10">然后重新启动 <code class="calibre7">apache</code> 即可生效</p>
<blockquote class="calibre5">
<p class="calibre14">域名.conf 文件通常是在 /usr/local/apache/conf 目录中，当然了这取决于你 LAMP 环境配置</p>
</blockquote>
<h2 id="nginx%2Ftengine+%E4%BF%AE%E6%94%B9%E6%96%B9%E6%B3%95" class="calibre15">Nginx/Tengine 修改方法</h2>
<p class="calibre10"><code class="calibre7">Nginx</code> 需要修改 <code class="calibre7">nginx.conf</code> 或者 <code class="calibre7">conf/vhost</code> 目录下 你的域名.conf 文件，如果你的生成环境是 LNMP/LTMP 一键安装包配置那么多半就是直接修改 你的域名.conf 文件</p>
<pre class="calibre21"><code class="calibre22">nginx
├─conf
    ├─vhost
        ├─www.thinkphp.cn.conf
    ├─nginx.conf
    ├─......
├─nginx.conf</code></pre>
<p class="calibre10">打开 你的域名.conf 文件 搜索 <code class="calibre7">open_basedir</code>,把</p>
<pre class="calibre21"><code class="calibre22">fastcgi_param  PHP_VALUE  "open_basedir=/home/wwwroot/www.thinkphp.cn/public/:/tmp/:/proc/";</code></pre>
<p class="calibre10">修改为</p>
<pre class="calibre21"><code class="calibre22">fastcgi_param  PHP_VALUE  "open_basedir=/home/wwwroot/www.thinkphp.cn/:/tmp/:/proc/";</code></pre>
<p class="calibre10">然后重新启动 Nginx 即可生效</p>
<blockquote class="calibre5">
<p class="calibre14">域名.conf 文件通常是在 /usr/local/nginx/conf/vhost 目录中，当然了这取决于你 LNMP/LTMP 环境配置</p>
</blockquote>
<h2 id="fpm%2Ffastcgi+user.ini+%E4%BF%AE%E6%94%B9%E6%96%B9%E6%B3%95" class="calibre15">fpm/fastcgi user.ini 修改方法</h2>
<p class="calibre10">打开 项目根目录下找到 user.ini 文件，搜索 <code class="calibre7">open_basedir</code>,把</p>
<pre class="calibre21"><code class="calibre22">open_basedir=/home/wwwroot/www.thinkphp.cn/public/:/tmp/:/proc/</code></pre>
<p class="calibre10">修改为</p>
<pre class="calibre21"><code class="calibre22">open_basedir=/home/wwwroot/www.thinkphp.cn/:/tmp/:/proc/</code></pre>
<p class="calibre10">然后重新启动 <code class="calibre7">web 服务器</code> 即可生效</p>
<h2 id="%E4%BF%AE%E6%94%B9+thinkphp5+%E5%85%A5%E5%8F%A3%E6%96%87%E4%BB%B6" class="calibre15">修改 ThinkPHP5 入口文件</h2>
<p class="calibre10">直接修改 ThinkPHP5 的入口文件会把你的框架文件及程序目录暴露在外网，敬请注意安全防护。<br class="calibre16"/>
修改入口文件方法请参考(<a href="129746" class="pcalibre calibre13"><strong class="calibre12">部署-虚拟主机环境</strong></a>)</p>
</div>
	
</body></html>
