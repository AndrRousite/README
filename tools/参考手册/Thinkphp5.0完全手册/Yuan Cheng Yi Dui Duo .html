<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
  <head>
    <title>远程一对多</title>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
        <h1 class="book-title" id="calibre_toc_114">远程一对多</h1>
<div class="book-content">
    <p class="calibre10">远程一对多关联用于定义有跨表的一对多关系，例如：</p>
<ul class="calibre23"><li class="calibre20">每个城市有多个用户</li>
<li class="calibre20">每个用户有多个话题</li>
<li class="calibre20">城市和话题之间并无关联</li>
</ul><h2 id="%E5%85%B3%E8%81%94%E5%AE%9A%E4%B9%89-1" class="calibre15">关联定义</h2>
<p class="calibre10">就可以直接通过远程一对多关联获取每个城市的多个话题，<code class="calibre7">City</code>模型定义如下：</p>
<pre class="calibre21"><code class="calibre22">namespace app\index\model;

use think\Model;

class City extends Model 
{
    public function topics()
    {
        return $this-&gt;hasManyThrough('Topic','User');
    }
}</code></pre>
<p class="calibre10">远程一对多关联，需要同时存在<code class="calibre7">Topic</code>和<code class="calibre7">User</code>模型。</p>
<p class="calibre10"><code class="calibre7">hasManyThrough</code>方法的参数如下：</p>
<blockquote class="info">
<h3 id="hasmanythrough%28%27%E5%85%B3%E8%81%94%E6%A8%A1%E5%9E%8B%E5%90%8D%27%2C%27%E4%B8%AD%E9%97%B4%E6%A8%A1%E5%9E%8B%E5%90%8D%27%2C%27%E5%A4%96%E9%94%AE%E5%90%8D%27%2C%27%E4%B8%AD%E9%97%B4%E6%A8%A1%E5%9E%8B%E5%85%B3%E8%81%94%E9%94%AE%E5%90%8D%27%2C%27%E5%BD%93%E5%89%8D%E6%A8%A1%E5%9E%8B%E4%B8%BB%E9%94%AE%E5%90%8D%27%2C%5B%27%E6%A8%A1%E5%9E%8B%E5%88%AB%E5%90%8D%E5%AE%9A%E4%B9%89%27%5D%29%3B" class="calibre17">hasManyThrough('关联模型名','中间模型名','外键名','中间模型关联键名','当前模型主键名',['模型别名定义']);</h3>
</blockquote>
<h2 id="%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2-1" class="calibre15">关联查询</h2>
<p class="calibre10">我们可以通过下面的方式获取关联数据</p>
<pre class="calibre21"><code class="calibre22">$city = City::get(1);
// 获取同城的所有话题
dump($city-&gt;topics);
// 也可以进行条件搜索
dump($city-&gt;topics()-&gt;where('topic.status',1)-&gt;select());</code></pre>
<blockquote class="calibre5">
<p class="calibre14">条件搜索的时候，需要带上模型名作为前缀</p>
</blockquote>
</div>
	
</body></html>
