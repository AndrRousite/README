<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
  <head>
    <title>join</title>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
        <h1 class="book-title">join</h1>
<div class="book-content">
    <p class="calibre10">join通常有下面几种类型，不同类型的join操作会影响返回的数据结果。</p>
<ul class="calibre23"><li class="calibre20"><strong class="calibre12">INNER JOIN</strong>: 等同于 JOIN（默认的JOIN类型）,如果表中有至少一个匹配，则返回行</li>
<li class="calibre20"><strong class="calibre12">LEFT JOIN</strong>: 即使右表中没有匹配，也从左表返回所有的行 </li>
<li class="calibre20"><strong class="calibre12">RIGHT JOIN</strong>: 即使左表中没有匹配，也从右表返回所有的行 </li>
<li class="calibre20"><strong class="calibre12">FULL JOIN</strong>: 只要其中一个表中存在匹配，就返回行 </li>
</ul><p class="calibre10"><strong class="calibre12">说明</strong></p>
<pre class="calibre21"><code class="calibre22">object join ( mixed join [, mixed $condition = null [, string $type = 'INNER']] )</code></pre>
<p class="calibre10">JOIN方法也是连贯操作方法之一，用于根据两个或多个表中的列之间的关系，从这些表中查询数据。</p>
<p class="calibre10"><strong class="calibre12">参数</strong></p>
<hr class="calibre8"/><h4 id="join" class="calibre6">join</h4>
<pre class="calibre21"><code class="calibre22">要关联的（完整）表名以及别名</code></pre>
<p class="calibre10">支持三种写法：</p>
<pre class="calibre21"><code class="calibre22">写法1：[ '完整表名或者子查询'=&gt;'别名' ]
写法2：'完整表名 别名'
写法3：'不带数据表前缀的表名'</code></pre>
<h4 id="condition" class="calibre6">condition</h4>
<pre class="calibre21"><code class="calibre22">关联条件。可以为字符串或数组， 为数组时每一个元素都是一个关联条件。</code></pre>
<h4 id="type" class="calibre6">type</h4>
<pre class="calibre21"><code class="calibre22">关联类型。可以为:INNER、LEFT、RIGHT、FULL，不区分大小写，默认为INNER。</code></pre>
<p class="calibre10"><strong class="calibre12">返回值</strong><br class="calibre16"/>
模型对象</p>
<p class="calibre10"><strong class="calibre12">举例</strong></p>
<hr class="calibre8"/><pre class="calibre21"><code class="calibre22">Db::table('think_artist')
-&gt;alias('a')
-&gt;join('think_work w','a.id = w.artist_id')
-&gt;join('think_card c','a.card_id = c.id')
-&gt;select();</code></pre>
<pre class="calibre21"><code class="calibre22">Db::table('think_artist')
-&gt;alias('a')
-&gt;join('__WORK__ w','a.id = w.artist_id')
-&gt;join('__CARD__ c','a.card_id = c.id')
-&gt;select();</code></pre>
<pre class="calibre21"><code class="calibre22">$join = [
    ['think_work w','a.id=w.artist_id'],
    ['think_card c','a.card_id=c.id'],
];
Db::table('think_user')-&gt;alias('a')-&gt;join($join)-&gt;select();</code></pre>
<p class="calibre10">以上三种写法的效果一样，<code class="calibre7">__WORK__</code>和 <code class="calibre7">__CARD__</code>在最终解析的时候会转换为 <code class="calibre7">think_work</code>和 <code class="calibre7">think_card</code>。注意:'_<em class="calibre36">表名_</em>'这种方式中间的表名需要用大写</p>
<p class="calibre10">如果不想使用别名，后面的条件就要使用表全名，可以使用下面这种方式</p>
<pre class="calibre21"><code class="calibre22">Db::table('think_user')-&gt;join('__WORK__','__ARTIST__.id = __WORK__.artist_id')-&gt;select();</code></pre>
<p class="calibre10">默认采用INNER JOIN 方式，如果需要用其他的JOIN方式，可以改成</p>
<pre class="calibre21"><code class="calibre22">Db::table('think_user')-&gt;alias('a')-&gt;join('word w','a.id = w.artist_id','RIGHT')-&gt;select();</code></pre>
<p class="calibre10">表名也可以是一个子查询</p>
<pre class="calibre21"><code class="calibre22">$subsql = Db::table('think_work')-&gt;where(['status'=&gt;1])-&gt;field('artist_id,count(id) count')-&gt;group('artist_id')-&gt;buildSql();
Db::table('think_user')-&gt;alias('a')-&gt;join([$subsql=&gt; 'w'], 'a.artist_id = w.artist_id')-&gt;select();</code></pre>
<p class="calibre10">因buildSql返回的语句带有()，所以这里不需要在两端再加上()。</p>
</div>
	
</body></html>
