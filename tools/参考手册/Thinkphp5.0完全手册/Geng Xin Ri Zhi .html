<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
  <head>
    <title>更新日志</title>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
        <h1 class="book-title" id="calibre_toc_224">更新日志</h1>
<div class="book-content">
    <h1 id="%E7%89%88%E6%9C%AC%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97" class="calibre9">版本更新日志</h1>
<div class="markdown-toc"><ul class="calibre23"><li class="calibre20"><a href="#2017-02-07+v5.0.6" class="pcalibre calibre13" level="2">2017-02-07 V5.0.6</a></li><li class="calibre20"><a href="#2017-01-23+v5.0.5" class="pcalibre calibre13" level="2">2017-01-23 V5.0.5</a></li><li class="calibre20"><a href="#2016-12-20+v5.0.4" class="pcalibre calibre13" level="2">2016-12-20 V5.0.4</a></li><li class="calibre20"><a href="#2016-11-11+v5.0.3" class="pcalibre calibre13" level="2">2016-11-11 V5.0.3</a></li><li class="calibre20"><a href="#2016-10-24+v5.0.2" class="pcalibre calibre13" level="2">2016-10-24 V5.0.2</a></li><li class="calibre20"><a href="#2016-9-28+v5.0.1" class="pcalibre calibre13" level="2">2016-9-28 V5.0.1</a></li><li class="calibre20"><a href="#2016-9-15+v5.0" class="pcalibre calibre13" level="2">2016-9-15 V5.0</a></li><li class="calibre20"><a href="#2016-7-1+rc4%E7%89%88%E6%9C%AC" class="pcalibre calibre13" level="2">2016-7-1 RC4版本</a></li><li class="calibre20"><a href="#2016-4-23+rc3%E7%89%88%E6%9C%AC" class="pcalibre calibre13" level="2">2016-4-23 RC3版本</a></li><li class="calibre20"><a href="#2016-3-11+rc2%E7%89%88%E6%9C%AC" class="pcalibre calibre13" level="2">2016-3-11 RC2版本</a></li><li class="calibre20"><a href="#2016-1-30+rc1%E7%89%88%E6%9C%AC" class="pcalibre calibre13" level="2">2016-1-30 RC1版本</a></li></ul></div>
<h2 id="2017-02-07+v5.0.6" class="calibre15">2017-02-07 V5.0.6</h2>
<h3 id="%E4%B8%BB%E8%A6%81%E8%B0%83%E6%95%B4%EF%BC%9A" class="calibre17">主要调整：</h3>
<p class="calibre10">本次更新主要为BUG修正及优化（可无缝升级）：</p>
<ul class="calibre23"><li class="calibre20">数据库支持断线重连机制；</li>
<li class="calibre20">改进查询事件的回调参数；</li>
<li class="calibre20">改进数据自动缓存机制；</li>
<li class="calibre20">增加时间字段自动格式转换设置；</li>
<li class="calibre20"><code class="calibre7">MongoDb</code>和<code class="calibre7">Oracle</code>扩展更新至最新核心框架；</li>
</ul><h3 id="%5B%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E6%A8%A1%E5%9E%8B%5D" class="calibre17">[数据库和模型]</h3>
<ul class="calibre23"><li class="calibre20">修正hasMany关联的<code class="calibre7">has</code>方法</li>
<li class="calibre20">去除一些数据库惯例配置 避免使用数据库扩展的时候影响</li>
<li class="calibre20">改进多对多的<code class="calibre7">attach</code>方法的返回值</li>
<li class="calibre20">增加Mysql的断线重连机制和开关</li>
<li class="calibre20">改进Query类的<code class="calibre7">find</code>方法数据缓存机制</li>
<li class="calibre20">改进Query类查询事件的回调参数</li>
<li class="calibre20">改进Query类的自动缓存更新</li>
<li class="calibre20">Model类增加<code class="calibre7">readonly</code>方法</li>
<li class="calibre20">改进Model类的<code class="calibre7">has</code>和<code class="calibre7">hasWhere</code>方法</li>
<li class="calibre20">改进模型类的<code class="calibre7">get</code>和<code class="calibre7">all</code>方法 第二个参数为true或者数字表示缓存参数</li>
<li class="calibre20">修复闭包查询条件为空导致的 sql 语法错误</li>
<li class="calibre20">改进Query类的<code class="calibre7">setBuilder</code>方法 避免因自定义连接器类后找不到生成器类</li>
<li class="calibre20">删除Connection类废弃属性<code class="calibre7">resultSetType</code></li>
<li class="calibre20">优化Connection类<code class="calibre7">close</code>方法</li>
<li class="calibre20">修正Connection类的<code class="calibre7">bindParam</code>方法对存储过程的支持</li>
<li class="calibre20">数据库配置参数<code class="calibre7">datetime_format</code> 设置为<code class="calibre7">false</code>表示关闭时间字段自动转换输出</li>
<li class="calibre20">改进软删除的数据库兼容性问题 支持<code class="calibre7">Mongodb</code></li>
</ul><h3 id="%5B%E5%85%B6%E5%AE%83%5D" class="calibre17">[其它]</h3>
<ul class="calibre23"><li class="calibre20">改进Url类生成 <code class="calibre7">root</code>为<code class="calibre7">/</code>的情况</li>
<li class="calibre20">redirect助手函数和controller类的redirect方法增加with参数</li>
<li class="calibre20">全局请求缓存添加排除规则 添加request_cache_except配置参数</li>
<li class="calibre20">Cache类store方法参数允许为空 表示获取当前缓存驱动句柄</li>
<li class="calibre20">改进Validate类的ip验证规则</li>
</ul><h2 id="2017-01-23+v5.0.5" class="calibre15">2017-01-23 V5.0.5</h2>
<h3 id="%E4%B8%BB%E8%A6%81%E8%B0%83%E6%95%B4%EF%BC%9A-1" class="calibre17">主要调整：</h3>
<p class="calibre10">本次更新主要改进了数据访问层和模型关联：</p>
<ul class="calibre23"><li class="calibre20">增加快捷查询及设置方法；</li>
<li class="calibre20">增加关联统计功能；</li>
<li class="calibre20">增加关联查询延迟预载入功能；</li>
<li class="calibre20">增加关联一对一自动写入和删除；</li>
<li class="calibre20">改进存储过程查询；</li>
<li class="calibre20">改进关联数据输出；</li>
<li class="calibre20">优化查询性能；</li>
<li class="calibre20">模型时间字段自动格式化输出；</li>
</ul><h3 id="%5B%E8%AF%B7%E6%B1%82%E5%92%8C%E8%B7%AF%E7%94%B1%5D" class="calibre17">[请求和路由]</h3>
<ul class="calibre23"><li class="calibre20">改进路由定义的后缀检测</li>
<li class="calibre20">Route类的<code class="calibre7">rest</code>方法支持覆盖定义</li>
<li class="calibre20">改进Request类的<code class="calibre7">put</code>和<code class="calibre7">post</code>方法对<code class="calibre7">json</code>格式参数的接收</li>
<li class="calibre20">Request类增加<code class="calibre7">contentType</code>方法</li>
<li class="calibre20">改进Route类<code class="calibre7">setRule</code>方法 </li>
<li class="calibre20">改进Request类的<code class="calibre7">create</code>方法</li>
<li class="calibre20">改进路由到控制器类的方法对默认渲染模板的影响</li>
<li class="calibre20">修正Url类<code class="calibre7">build</code>方法定义路由别名后的BUG</li>
</ul><h3 id="%5B%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E6%A8%A1%E5%9E%8B%5D-1" class="calibre17">[数据库和模型]</h3>
<ul class="calibre23"><li class="calibre20">增加关联统计功能</li>
<li class="calibre20">增加一对一关联自动写入功能</li>
<li class="calibre20">修正聚合模型的<code class="calibre7">delete</code>方法</li>
<li class="calibre20">改进Model类的<code class="calibre7">useGlobalScope</code>方法</li>
<li class="calibre20">Model类的日期类型支持设置为类名</li>
<li class="calibre20">Query类增加<code class="calibre7">data</code>/<code class="calibre7">inc</code>/<code class="calibre7">dec</code>/<code class="calibre7">exp</code>方法用于快捷设置数据 <code class="calibre7">insert</code>和<code class="calibre7">update</code>方法参数可以为空 读取<code class="calibre7">data</code>设置数据</li>
<li class="calibre20">优化Connection的查询性能</li>
<li class="calibre20">修正Builder类的<code class="calibre7">parseOrder</code>方法</li>
<li class="calibre20">修正BelongsToMany类的<code class="calibre7">attach</code>方法</li>
<li class="calibre20">BelongsToMany类的<code class="calibre7">attach</code>方法改进 支持批量写入</li>
<li class="calibre20">改进BelongsToMany类的<code class="calibre7">saveall</code>方法 增加第三个参数 用于指定额外参数是否一致</li>
<li class="calibre20">Query类的<code class="calibre7">order</code>方法支持多次调用合并</li>
<li class="calibre20">改进<code class="calibre7">count</code>方法对<code class="calibre7">group</code>查询的支持</li>
<li class="calibre20">增加时间戳自动写入的判断</li>
<li class="calibre20">改进Model类<code class="calibre7">writeTransform</code>方法</li>
<li class="calibre20">改进Model的时间戳字段写入和读取</li>
<li class="calibre20">写入数据为对象的时候检测是否有<code class="calibre7">__toString</code>方法</li>
<li class="calibre20">改进Mysql驱动的<code class="calibre7">getFields</code>方法</li>
<li class="calibre20">改进自动时间字段的输出</li>
<li class="calibre20"><code class="calibre7">like</code>查询条件支持数组</li>
<li class="calibre20">自动时间字段的获取自动使用时间格式化</li>
<li class="calibre20">改进单个字段多次Or查询情况的查询</li>
<li class="calibre20">修正<code class="calibre7">null</code>查询的条件合并</li>
<li class="calibre20">改进Query类<code class="calibre7">paginate</code>方法第一个参数可以使用数组参数</li>
<li class="calibre20">改进数据集对象的返回，由Query类的select方法进行数据集转换，原生查询不再支持返回数据集对象</li>
<li class="calibre20">增加<code class="calibre7">whereNull</code>、<code class="calibre7">whereIn</code>等一系列快捷查询方法</li>
<li class="calibre20"><code class="calibre7">fetchPdo</code>方法调整</li>
<li class="calibre20">改进对存储过程调用的支持 改进<code class="calibre7">getRealSql</code>的调用机制 改进数据表字段使用中划线的参数绑定支持</li>
<li class="calibre20">数据库配置参数增加<code class="calibre7">result_type</code> 用于设置数据返回类型 方法参数名称调整</li>
<li class="calibre20">改进Query类的<code class="calibre7">whereTime</code>方法支持更多的时间日期表达式（默认查询条件为大于指定时间表达式）</li>
<li class="calibre20">取消<code class="calibre7">min</code>/<code class="calibre7">max</code>/<code class="calibre7">sum</code>/<code class="calibre7">avg</code>方法的参数默认值</li>
<li class="calibre20">Query类增加<code class="calibre7">getPdo</code>方法用于返回<code class="calibre7">PDOStatement</code>对象</li>
<li class="calibre20">改进<code class="calibre7">today</code>的日期表达式查询</li>
<li class="calibre20">改进关联属性的获取</li>
<li class="calibre20">改进关联定义中包含查询条件后重复执行的问题</li>
<li class="calibre20">改进参数绑定支持中文字段自动绑定</li>
<li class="calibre20">改进Builder类的<code class="calibre7">insertall</code>方法 增加对null和对象数据的处理</li>
<li class="calibre20">改进参数绑定类型 支持<code class="calibre7">bit</code>类型自动绑定</li>
<li class="calibre20">Connection类<code class="calibre7">model</code>方法更改为<code class="calibre7">getQuery</code></li>
<li class="calibre20">优化Connection类<code class="calibre7">__call</code>方法</li>
<li class="calibre20">修正聚合模型</li>
<li class="calibre20">一对一关联预载入默认改为IN查询方式</li>
<li class="calibre20">增加<code class="calibre7">collection</code>助手函数用于数据集转换</li>
<li class="calibre20">增加<code class="calibre7">load_relation</code>助手函数用于数组的延迟预载入</li>
<li class="calibre20">改进Model类的<code class="calibre7">has</code>方法第二个参数支持使用数组和闭包，无需再使用<code class="calibre7">hasWhere</code></li>
<li class="calibre20"><code class="calibre7">relation</code>方法支持嵌套关联查询</li>
<li class="calibre20">增加<code class="calibre7">think\model\Collection</code>作为模型的数据集查询集合对象</li>
<li class="calibre20">取消关联定义的<code class="calibre7">alias</code>参数（仅<code class="calibre7">morphTo</code>保留）</li>
<li class="calibre20">Model类的<code class="calibre7">delete</code>方法，支持没有主键的情况</li>
<li class="calibre20">Model类的<code class="calibre7">allowField</code>方法支持逗号分割的字符串</li>
<li class="calibre20">改进写入数据的自动参数绑定的参数名混淆问题</li>
<li class="calibre20">关联预载入查询的属性名默认使用小写+下划线命名</li>
<li class="calibre20">Query类的<code class="calibre7">with</code>和<code class="calibre7">relation</code>方法支持多次调用</li>
<li class="calibre20">Collection类增加<code class="calibre7">hidden</code>、<code class="calibre7">visible</code>和<code class="calibre7">append</code>方法</li>
<li class="calibre20">修正软删除的强制删除方法</li>
</ul><h3 id="%5B%E5%85%B6%E5%AE%83%5D-1" class="calibre17">[其它]</h3>
<ul class="calibre23"><li class="calibre20"><code class="calibre7">unique</code>验证规则支持指定完整模型类 并且默认会优先检测模型类是否存在 不存在则检测数据表</li>
<li class="calibre20">改进<code class="calibre7">Loader</code>类的<code class="calibre7">model</code>、<code class="calibre7">controller</code> 和 <code class="calibre7">validate</code>方法 支持直接传入类名实例化</li>
<li class="calibre20"><code class="calibre7">Session</code>类增加安全选项<code class="calibre7">httponly</code>和<code class="calibre7">secure</code></li>
<li class="calibre20">可以允许自定义<code class="calibre7">Output</code>的driver，以适应命令行模式下调用其它命令行指令 </li>
<li class="calibre20">改进<code class="calibre7">loader</code>类<code class="calibre7">action</code>的参数污染问题</li>
<li class="calibre20">Validate类的<code class="calibre7">confirm</code>验证改为恒等判断</li>
<li class="calibre20">改进<code class="calibre7">Validate</code>类的错误信息处理</li>
<li class="calibre20">修正<code class="calibre7">Validate</code>类的布尔值规则验证</li>
<li class="calibre20">改进<code class="calibre7">cookie</code>助手函数对前缀的支持</li>
<li class="calibre20">文件缓存默认开启子目录缓存避免文件过多导致性能问题</li>
</ul><h3 id="%5B%E8%B0%83%E6%95%B4%5D" class="calibre17">[调整]</h3>
<ul class="calibre23"><li class="calibre20">Connection类<code class="calibre7">model</code>方法更改为<code class="calibre7">getQuery</code></li>
<li class="calibre20">原生查询不再支持返回数据集对象</li>
<li class="calibre20">分页查询返回类型变成<code class="calibre7">think\Paginator</code>（用法不变）</li>
<li class="calibre20">模型的时间日期字段会自动进行格式化输出，不需要进行额外处理。</li>
<li class="calibre20">Session类添加了<code class="calibre7">secure</code>和<code class="calibre7">httponly</code>参数，并且默认是true</li>
</ul><h2 id="2016-12-20+v5.0.4" class="calibre15">2016-12-20 V5.0.4</h2>
<h3 id="%E4%B8%BB%E8%A6%81%E8%B0%83%E6%95%B4%EF%BC%9A-2" class="calibre17">主要调整：</h3>
<ul class="calibre23"><li class="calibre20">关联模型重构并增加多态一对多关联；</li>
<li class="calibre20">数据库支持一个字段多次调用不同查询条件；</li>
<li class="calibre20">增加数据库CURD事件支持；</li>
<li class="calibre20">路由到类和控制器的方法支持传入额外参数；</li>
<li class="calibre20">支持全局模板变量赋值；</li>
<li class="calibre20">模型支持独立设置查询数据集对象；</li>
<li class="calibre20">日志针对命令行及调试做出改进；</li>
<li class="calibre20">改进Hook类的行为方法调用</li>
</ul><h3 id="%5B%E8%AF%B7%E6%B1%82%E5%92%8C%E8%B7%AF%E7%94%B1%5D-1" class="calibre17">[请求和路由]</h3>
<ul class="calibre23"><li class="calibre20">请求缓存支持模块单独开启</li>
<li class="calibre20">Request类<code class="calibre7">post</code>方法支持获取<code class="calibre7">json</code>方式的请求数据</li>
<li class="calibre20">路由到类的方法和控制器方法 支持传入额外参数，用于方法的参数</li>
<li class="calibre20">改进控制器自动搜索的目录规范</li>
<li class="calibre20">改进请求缓存</li>
<li class="calibre20">改进自动参数绑定</li>
<li class="calibre20">修正路由的请求缓存设置</li>
<li class="calibre20">改进Route类name方法</li>
</ul><h3 id="%5B%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E6%A8%A1%E5%9E%8B%5D-2" class="calibre17">[数据库和模型]</h3>
<ul class="calibre23"><li class="calibre20">增加数据库查询（CURD）事件</li>
<li class="calibre20">改进多表更新的字段不存在问题</li>
<li class="calibre20">改进Model类的<code class="calibre7">useGlobalScope</code>方法</li>
<li class="calibre20">修正子查询作为表名查询的问题</li>
<li class="calibre20">Model类增加<code class="calibre7">resultSetType</code>属性 用于指定模型查询的数据集对象（默认为空返回数组） </li>
<li class="calibre20">Model类增加<code class="calibre7">toCollection</code>方法（自动调用）</li>
<li class="calibre20">关联模型架构调整</li>
<li class="calibre20">改进预载入<code class="calibre7">with</code>方法的参数支持小写和下划线定义</li>
<li class="calibre20">修正关联多对多一处错误</li>
<li class="calibre20">改进关联多对多的查询</li>
<li class="calibre20">关联模型支持多态一对多关联</li>
<li class="calibre20">预载入关联查询支持关联对象属性绑定到当前模型</li>
<li class="calibre20">支持追加关联对象的属性到当前模型数据</li>
<li class="calibre20">一对一关联预载入支持JOIN和IN两种方式（默认为JOIN）</li>
<li class="calibre20">改进多对多查询</li>
<li class="calibre20">改进模型更新的数据变化比较规则</li>
<li class="calibre20">查询支持一个字段多次查询条件</li>
<li class="calibre20">改进sql日志的sql语句</li>
<li class="calibre20">修正<code class="calibre7">join</code>自身表的别名覆盖问题</li>
<li class="calibre20">模型类的<code class="calibre7">connection</code>属性和数据库默认配置合并</li>
<li class="calibre20">改进<code class="calibre7">in</code>和<code class="calibre7">between</code>查询条件的自动参数绑定</li>
<li class="calibre20">改进Query类对数据集对象以及关联字段排序的支持</li>
<li class="calibre20">增加模型的快捷事件方法</li>
<li class="calibre20">改进Query类的<code class="calibre7">getTableInfo</code>方法缓存读取</li>
<li class="calibre20">model类的<code class="calibre7">saveAll</code>方法支持调用<code class="calibre7">allowField</code>方法进行字段过滤</li>
<li class="calibre20">修正关联查询的时候 <code class="calibre7">whereTime</code>方法的bug</li>
<li class="calibre20">改进Query类的聚合查询</li>
<li class="calibre20">table方法支持字符串方式的子查询</li>
<li class="calibre20">修正<code class="calibre7">count</code> <code class="calibre7">avg</code>方法使用<code class="calibre7">fetchsql</code>无法正确返回sql的问题</li>
</ul><h3 id="%5B%E5%85%B6%E5%AE%83%5D-2" class="calibre17">[其它]</h3>
<ul class="calibre23"><li class="calibre20">改进命令行下的日志记录</li>
<li class="calibre20">部署模式下简化日志记录</li>
<li class="calibre20">增加debug日志类型 仅限调试模式记录</li>
<li class="calibre20">改进Template类<code class="calibre7">parseTemplateFile</code>方法</li>
<li class="calibre20">改进Validate类的<code class="calibre7">getRuleMsg</code>方法</li>
<li class="calibre20">控制器的<code class="calibre7">error</code>方法在AJAX请求默认返回url为空</li>
<li class="calibre20">Validate类架构方法增加<code class="calibre7">field</code>参数 用于设置验证字段的描述</li>
<li class="calibre20">改进App类<code class="calibre7">invokeMethod</code>方法对架构函数依赖注入的支持</li>
<li class="calibre20">增加RedirectResponse的<code class="calibre7">restore</code>方法返回值</li>
<li class="calibre20">View类增加<code class="calibre7">share</code>静态方法 用于静态赋值模板变量</li>
<li class="calibre20">验证类增加<code class="calibre7">hasScene</code>方法判断是否存在某个场景的验证配置</li>
<li class="calibre20">修正redis和session驱动的<code class="calibre7">destroy</code>方法返回值</li>
<li class="calibre20">空操作方法的参数传入去掉操作方法后缀</li>
<li class="calibre20">在控制器中调用request和view增加类型提示</li>
<li class="calibre20">改进<code class="calibre7">input</code>助手函数支持多维数据获取</li>
<li class="calibre20">Cache类增加<code class="calibre7">pull</code>和<code class="calibre7">remember</code>方法</li>
<li class="calibre20">改进验证类的<code class="calibre7">confirm</code>验证规则 支持自动规则识别</li>
<li class="calibre20">改进验证类的错误信息定义</li>
<li class="calibre20">增加Validate类自定义验证错误信息的替换规则</li>
<li class="calibre20">Cookie类增加<code class="calibre7">forever</code>方法用于永久保存</li>
<li class="calibre20">模板渲染支持从视图根目录读取模板</li>
<li class="calibre20">改进Hook类的exec方法</li>
</ul><h3 id="%5B%E8%B0%83%E6%95%B4%5D-1" class="calibre17">[调整]</h3>
<ul class="calibre23"><li class="calibre20">Db类查询不再支持设置自定义数据集对象</li>
<li class="calibre20">废除Query类的<code class="calibre7">fetchClass</code>方法</li>
<li class="calibre20">控制器的<code class="calibre7">error</code>方法在AJAX请求默认返回的url为空</li>
<li class="calibre20">关联方法定义不支持使用小写下划线，必须使用驼峰法</li>
<li class="calibre20">行为类的方法必须使用驼峰法命名</li>
</ul><h2 id="2016-11-11+v5.0.3" class="calibre15">2016-11-11 V5.0.3</h2>
<h3 id="%E4%B8%BB%E8%A6%81%E8%B0%83%E6%95%B4%EF%BC%9A-3" class="calibre17">主要调整：</h3>
<ul class="calibre23"><li class="calibre20">请求缓存增强；</li>
<li class="calibre20">路由增强；</li>
<li class="calibre20">数据库和模型完善；</li>
<li class="calibre20">支持反射的异常捕获；</li>
<li class="calibre20">File类改进；</li>
<li class="calibre20">修正社区反馈的一些BUG；</li>
</ul><h3 id="%5B+%E8%AF%B7%E6%B1%82%E5%92%8C%E8%B7%AF%E7%94%B1+%5D" class="calibre17">[ 请求和路由 ]</h3>
<ul class="calibre23"><li class="calibre20">资源路由自动注册的路由规则的时候会记录当前使用的资源标识；</li>
<li class="calibre20">增强请求缓存功能和规则定义，支持全局自动缓存</li>
<li class="calibre20">修正控制器自动搜索的大小写问题</li>
<li class="calibre20">修正路由绑定到命名空间后 类的自动定位</li>
<li class="calibre20">改进Route类的parseRule方法 路由地址中的变量替换不自动去除路由变量</li>
<li class="calibre20">改进控制器自动搜索</li>
<li class="calibre20">Route类增加setOption和getOption方法 用于记录当前路由执行过程中的参数信息</li>
<li class="calibre20">优化路由分组方法</li>
<li class="calibre20">改进分组路由的url生成</li>
</ul><h3 id="%5B+%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E6%A8%A1%E5%9E%8B+%5D" class="calibre17">[ 数据库和模型 ]</h3>
<ul class="calibre23"><li class="calibre20">一对一关联查询方法支持定义<code class="calibre7">field</code>方法</li>
<li class="calibre20">聚合模型支持设置<code class="calibre7">field</code>属性</li>
<li class="calibre20">改进Query类的<code class="calibre7">alias</code>方法</li>
<li class="calibre20">改进Query类<code class="calibre7">join</code>和<code class="calibre7">view</code>方法的table参数</li>
<li class="calibre20">改进Query类<code class="calibre7">where</code>方法</li>
<li class="calibre20">改进Query类的<code class="calibre7">paginate</code>方法，支持<code class="calibre7">order</code>方法</li>
<li class="calibre20">改进Query类的<code class="calibre7">min</code>和<code class="calibre7">max</code>方法支持日期类型</li>
<li class="calibre20">修正软删除<code class="calibre7">withTrashed</code>方法</li>
<li class="calibre20">优化Connection类的<code class="calibre7">getRealSql</code>方法生成的sql</li>
</ul><h3 id="%5B+%E5%85%B6%E5%AE%83+%5D" class="calibre17">[ 其它 ]</h3>
<ul class="calibre23"><li class="calibre20">增加request_cache和request_cache_expire配置参数用于配置全局请求缓存；</li>
<li class="calibre20">修正input助手函数的数组过滤</li>
<li class="calibre20">cache助手函数支持清空操作</li>
<li class="calibre20">改进Config类load方法 一级配置名称强制转为小写</li>
<li class="calibre20">修正Url多次生成的问题</li>
<li class="calibre20">File类修正某些环境下面无法识别上传文件的问题</li>
<li class="calibre20">改进App类的空操作方法调用</li>
<li class="calibre20">域名部署URL生成不依赖 url_domain_deploy 配置参数</li>
<li class="calibre20">修正Url类域名部署的问题</li>
<li class="calibre20">视图文件目录支持集中式存放 不放入模块目录</li>
<li class="calibre20">cache助手函数支持 remember方法</li>
<li class="calibre20">Request类的input方法或者input助手函数的<code class="calibre7">filter</code>参数支持传入null 表示不过滤</li>
</ul><h2 id="2016-10-24+v5.0.2" class="calibre15">2016-10-24 V5.0.2</h2>
<h3 id="%E4%B8%BB%E8%A6%81%E8%B0%83%E6%95%B4%EF%BC%9A-4" class="calibre17">主要调整：</h3>
<ul class="calibre23"><li class="calibre20">数据库和模型完善；</li>
<li class="calibre20">路由功能完善；</li>
<li class="calibre20">增加<code class="calibre7">yaml</code>配置格式支持；</li>
<li class="calibre20">依赖注入完善；</li>
<li class="calibre20">Session类完善；</li>
<li class="calibre20">Cookie类完善；</li>
<li class="calibre20">Validate类完善；</li>
<li class="calibre20">支持反射类的异常捕获；</li>
<li class="calibre20">修正社区反馈BUG；</li>
</ul><h3 id="%5B+%E8%AF%B7%E6%B1%82%E5%92%8C%E8%B7%AF%E7%94%B1+%5D-1" class="calibre17">[ 请求和路由 ]</h3>
<ul class="calibre23"><li class="calibre20">依赖注入的类如果定义了<code class="calibre7">invoke</code>方法则自动调用</li>
<li class="calibre20">Request类的<code class="calibre7">header</code>方法增加自定义header支持</li>
<li class="calibre20">Request类禁止直接实例化调用</li>
<li class="calibre20">改进Request类ip方法</li>
<li class="calibre20">路由变量规则支持闭包定义</li>
<li class="calibre20">路由参数增加<code class="calibre7">ajax</code>和<code class="calibre7">pjax</code>判断</li>
<li class="calibre20">别名路由增加允许和排除操作</li>
<li class="calibre20">改进路由域名绑定后的url生成</li>
<li class="calibre20">路由生成改进对路由到类的支持</li>
<li class="calibre20">路由生成支持<code class="calibre7">url_param_type</code>配置参数</li>
<li class="calibre20">路由生成支持别名路由</li>
<li class="calibre20">Route重定向规则支持更多<code class="calibre7">schema</code></li>
<li class="calibre20">别名路由支持定义单独方法的请求类型</li>
<li class="calibre20">改进路由分组的url生成</li>
<li class="calibre20">路由规则的组合变量支持可选分隔符定义</li>
<li class="calibre20">改进路由合并参数的获取</li>
<li class="calibre20">路由规则支持单独设置url分隔符，路由参数为 <code class="calibre7">param_depr</code></li>
<li class="calibre20">自动搜索控制器支持自定义访问控制器层的情况</li>
<li class="calibre20">改进路由标识不区分大小写</li>
<li class="calibre20">改进路由地址是否定义过路由规则的检测</li>
</ul><h3 id="%5B+%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E6%A8%A1%E5%9E%8B+%5D-1" class="calibre17">[ 数据库和模型 ]</h3>
<ul class="calibre23"><li class="calibre20">改进Query类的join方法</li>
<li class="calibre20">改进Query类分页方法的参数绑定</li>
<li class="calibre20">修正软删除方法</li>
<li class="calibre20">修正Query类parseOrder方法一处错误</li>
<li class="calibre20">修正sqlsrv驱动parseOrder方法</li>
<li class="calibre20">修正Query类setInc和setDec方法</li>
<li class="calibre20">改进Model类的save方法支持非自增主键的处理</li>
<li class="calibre20">整型字段的参数绑定如果为空写入默认值0</li>
<li class="calibre20">改进Model类has和hasWhere方法</li>
<li class="calibre20">改进Query类的value方法缓存判断</li>
<li class="calibre20">改进Query类join方法对子查询支持</li>
<li class="calibre20">改进Query类的table方法和alias方法用法</li>
<li class="calibre20">关联预载入支持<code class="calibre7">hasOne</code>自关联</li>
<li class="calibre20">改进Builder类的parseKey方法</li>
<li class="calibre20">改进Builder类的join/alias/table方法的解析</li>
<li class="calibre20">改进全局查询范围</li>
<li class="calibre20">改进Query类的聚合查询方法的返回值</li>
<li class="calibre20">改进关联属性的读取</li>
<li class="calibre20">改进聚合模型主键和关联键相同的情况</li>
<li class="calibre20">改进模型在开启<code class="calibre7">class_suffix</code>参数情况下的name属性的识别</li>
</ul><h3 id="%5B+%E5%85%B6%E5%AE%83+%5D-1" class="calibre17">[ 其它 ]</h3>
<ul class="calibre23"><li class="calibre20">Cache类增加<code class="calibre7">remember</code>方法 用于当获取的缓存不存在的时候自动写入</li>
<li class="calibre20">Session类增加<code class="calibre7">flash</code>方法用于设置下一次请求有效的值 </li>
<li class="calibre20">Session类增加<code class="calibre7">flush</code>方法用于清空当前请求有效的值 </li>
<li class="calibre20">Session类增加<code class="calibre7">push</code>方法用于更新数组数据</li>
<li class="calibre20">增加yaml配置格式支持</li>
<li class="calibre20">改进App类的反射异常无法捕获问题</li>
<li class="calibre20">修正session助手函数的清空操作</li>
<li class="calibre20">改进验证类的<code class="calibre7">image</code>方法</li>
<li class="calibre20">改进验证类的<code class="calibre7">activeUrl</code>方法 </li>
<li class="calibre20">改进自定义验证规则的使用</li>
<li class="calibre20">改进控制器自动搜索后的控制器名获取</li>
<li class="calibre20">修正import方法加载extend目录类库</li>
<li class="calibre20">修正json_encode时 "Failed calling XXX::jsonSerialize()" 的异常</li>
<li class="calibre20">改进Loader类model和validate方法的单例问题</li>
<li class="calibre20">改进方法执行的日志记录</li>
<li class="calibre20">改进模板引擎的Think变量解析</li>
<li class="calibre20">改进Lang类<code class="calibre7">load</code>方法</li>
<li class="calibre20">验证错误信息支持多语言读取</li>
<li class="calibre20">改进ROOT_PATH常量</li>
<li class="calibre20">改进语言包加载</li>
<li class="calibre20">改进模板session和cookie变量获取，自动判断前缀</li>
<li class="calibre20">缓存驱动统一增加handler方法用于获取操作对象的句柄（某些缓存类型可能为null）</li>
<li class="calibre20">File类增加<code class="calibre7">__call</code>方法用于兼容5.0版本的<code class="calibre7">md5</code>和 <code class="calibre7">sha1</code>方法</li>
<li class="calibre20">改进文件缓存驱动的<code class="calibre7">clear</code>方法</li>
<li class="calibre20">Lang类增加<code class="calibre7">setLangCookieExpire</code>方法设置多语言cookie过期时间</li>
<li class="calibre20">增加<code class="calibre7">route_complete_match</code>配置参数</li>
</ul><h3 id="%5B+%E8%B0%83%E6%95%B4+%5D" class="calibre17">[ 调整 ]</h3>
<p class="calibre10">下列模型属性和方法由原来的静态（static）定义改为动态定义：</p>
<ul class="calibre23"><li class="calibre20">聚合模型的<code class="calibre7">relationModel</code>属性</li>
<li class="calibre20">Model类的<code class="calibre7">useGlobalScope</code>属性</li>
<li class="calibre20">全局查询范围方法<code class="calibre7">base</code>改为动态方法</li>
<li class="calibre20">软删除属性 <code class="calibre7">deleteTime</code>属性</li>
</ul><h2 id="2016-9-28+v5.0.1" class="calibre15">2016-9-28 V5.0.1</h2>
<h3 id="%E4%B8%BB%E8%A6%81%E8%B0%83%E6%95%B4%EF%BC%9A-5" class="calibre17">主要调整：</h3>
<ul class="calibre23"><li class="calibre20"><a href="215849" class="pcalibre calibre13">依赖注入</a>完善；</li>
<li class="calibre20"><a href="118027" class="pcalibre calibre13">扩展配置</a>文件位置调整；</li>
<li class="calibre20">新增数据表<a href="211524" class="pcalibre calibre13">字段缓存命令</a>；</li>
<li class="calibre20">支持设置当前的查询对象；</li>
<li class="calibre20">支持<a href="215850" class="pcalibre calibre13">请求和路由缓存</a>；</li>
</ul><h3 id="%5B+%E8%AF%B7%E6%B1%82%E5%92%8C%E8%B7%AF%E7%94%B1+%5D-2" class="calibre17">[ 请求和路由 ]</h3>
<ul class="calibre23"><li class="calibre20">改进Controller类的<code class="calibre7">success</code>和<code class="calibre7">error</code>方法的跳转地址识别 支持更多Scheme</li>
<li class="calibre20">操作方法和架构方法支持任何对象自动注入</li>
<li class="calibre20">Requesst类增加<code class="calibre7">getInput</code>方法 用于获取<code class="calibre7">php://input</code>值</li>
<li class="calibre20">路由到方法的时候 支持架构方法注入请求对象</li>
<li class="calibre20">改进Route类路由到类的判断</li>
<li class="calibre20">Request增加<code class="calibre7">cache</code>方法，支持请求缓存</li>
<li class="calibre20">绑定到模块后 路由依然优先检查</li>
<li class="calibre20">路由增加请求缓存参数</li>
<li class="calibre20">修正路由组合变量的可选变量的BUG</li>
</ul><h3 id="%5B+%E6%95%B0%E6%8D%AE%E5%BA%93+%5D" class="calibre17">[ 数据库 ]</h3>
<ul class="calibre23"><li class="calibre20">修正<code class="calibre7">pgsql</code>数据库驱动的数据表字段信息读取</li>
<li class="calibre20">改进Query类的<code class="calibre7">view</code>方法 第二个参数默认值更改为true 获取全部的字段</li>
<li class="calibre20">数据库配置信息增加<code class="calibre7">query</code>参数用于配置查询对象名称</li>
<li class="calibre20">型类增加<code class="calibre7">query</code>属性用于配置模型需要的查询对象名称</li>
<li class="calibre20">改进数据表字段缓存读取</li>
<li class="calibre20">改进数据表字段缓存生成 模型为抽象类或者 没有继承Model类 不生成字段缓存</li>
<li class="calibre20">改进模型的字段缓存 虚拟模型不生成字段缓存</li>
<li class="calibre20">改进数据表字段缓存生成 支持读取模块的模型生成</li>
<li class="calibre20">改进聚合模型的<code class="calibre7">save</code>方法 主键写入</li>
<li class="calibre20">模型类的field属性定义简化 取消<code class="calibre7">Query</code>类的<code class="calibre7">allowField</code>和<code class="calibre7">setFieldType</code>方法及相关属性</li>
<li class="calibre20">改进数据表字段缓存生成 支持生成多个数据库的</li>
<li class="calibre20">更新数据库驱动类 改进<code class="calibre7">getTables</code>方法</li>
<li class="calibre20">增加<code class="calibre7">optimize:schema</code> 命令 用于生成数据表字段信息缓存</li>
<li class="calibre20">修正一个查询条件多个条件的时候的参数绑定BUG</li>
<li class="calibre20">分页查询方法<code class="calibre7">paginate</code>第二个参数传入数字表示总记录数</li>
<li class="calibre20">修正mysql的<code class="calibre7">JSON</code>字段查询</li>
<li class="calibre20">改进Query类的getOptions方法 当name参数不存在的时候返回null</li>
</ul><h3 id="%5B+%E6%A8%A1%E5%9E%8B%E5%92%8C%E5%85%B3%E8%81%94+%5D" class="calibre17">[ 模型和关联 ]</h3>
<ul class="calibre23"><li class="calibre20">模型类的field属性不需要添加字段类型定义</li>
<li class="calibre20">改进Model类 添加<code class="calibre7">getDb</code>静态方法获取db查询对象</li>
<li class="calibre20">改进聚合模型<code class="calibre7">save</code>方法返回值</li>
<li class="calibre20">改进Relation类<code class="calibre7">save</code>方法</li>
<li class="calibre20">修正关联模型 多对多<code class="calibre7">save</code>方法一处问题</li>
<li class="calibre20">改进Model类的save方法 修正不按主键查询的更新问题</li>
<li class="calibre20">时间字段获取器获取的时候为NULL则不做转换</li>
</ul><h3 id="%5B+%E5%85%B6%E5%AE%83+%5D-2" class="calibre17">[ 其它 ]</h3>
<ul class="calibre23"><li class="calibre20">改进配置缓存生成 支持扩展配置</li>
<li class="calibre20">取消<code class="calibre7">extra_config_list</code>配置参数 扩展配置文件直接放到 <code class="calibre7">extra</code>目录下面即可自动加载（数据库配置文件位置不变）</li>
<li class="calibre20">cache助手函数支持判断缓存是否有效</li>
<li class="calibre20">修正 模板引擎驱动类的<code class="calibre7">config</code>方法</li>
<li class="calibre20">修复在配置Model属性field=true情况下,通过<code class="calibre7">__call</code>调用db()引发的BUG</li>
<li class="calibre20">改进模板引擎驱动的config方法 支持获取配置参数值</li>
<li class="calibre20">改进redirct的url地址解析</li>
<li class="calibre20">删除<code class="calibre7">File</code>类的<code class="calibre7">md5</code>和<code class="calibre7">sha1</code>方法 改为<code class="calibre7">hash</code>方法 支持更多的散列值类型生成</li>
<li class="calibre20">增加<code class="calibre7">response_end</code>行为标签</li>
<li class="calibre20">改进默认语言的加载</li>
</ul><h2 id="2016-9-15+v5.0" class="calibre15">2016-9-15 V5.0</h2>
<h3 id="%5B+%E8%AF%B7%E6%B1%82%E5%92%8C%E8%B7%AF%E7%94%B1+%5D-3" class="calibre17">[ 请求和路由 ]</h3>
<ul class="calibre23"><li class="calibre20">Request对象支持动态绑定属性</li>
<li class="calibre20">定义了路由规则的URL原地址禁止访问</li>
<li class="calibre20">改进路由规则存储结构</li>
<li class="calibre20">路由分组功能增强，支持嵌套和虚拟分组</li>
<li class="calibre20">路由URL高效反解</li>
<li class="calibre20">改进Request对象param方法获取优先级</li>
<li class="calibre20">路由增加name方法设置和获取路由标识</li>
<li class="calibre20">增加MISS和AUTO路由规则</li>
<li class="calibre20">Route类增加auto方法 支持注册一个自动解析URL的路由</li>
<li class="calibre20">路由规则支持模型绑定</li>
<li class="calibre20">路由变量统一使用param方法获取</li>
<li class="calibre20">路由规则标识功能和自动标识</li>
<li class="calibre20">增加生成路由缓存指令 optimize:route</li>
<li class="calibre20">Request对象增加route方法单独获取路由变量</li>
<li class="calibre20">Request对象的param get post put request delete server cookie env方法的第一个参数传入false 则表示获取原始数据 不进行过滤</li>
<li class="calibre20">改进自动路由标识生成 支持不同的路由规则 指向同一个路由标识，改进Url自动生成对路由标识的支持</li>
<li class="calibre20">改进Request类 filter属性的初始化</li>
<li class="calibre20">改进Request类的isAjax和isPjax方法</li>
<li class="calibre20">Request类增加token方法</li>
<li class="calibre20">路由配置文件支持多个 使用 route_config_file 配置参数配置</li>
<li class="calibre20">域名绑定支持https检测</li>
<li class="calibre20">改进域名绑定 支持同时绑定模块和其他 支持绑定到数组定义的路由规则，取消域名绑定到分组</li>
<li class="calibre20">路由规则增加PATCH请求类型支持</li>
<li class="calibre20">增加route_complete_match配置参数设置全局路由规则定义是否采用完整匹配 可以由路由规则的参数complete_match 进行覆盖</li>
<li class="calibre20">改进路由的 后缀参数识别 优先于系统的伪静态后缀参数</li>
<li class="calibre20">Url类增加root方法用于指定当前root地址（不含域名）</li>
<li class="calibre20">改进Url生成对可选参数的支持</li>
</ul><h3 id="%5B+%E6%95%B0%E6%8D%AE%E5%BA%93+%5D-1" class="calibre17">[ 数据库 ]</h3>
<ul class="calibre23"><li class="calibre20">查询条件自动参数绑定</li>
<li class="calibre20">改进分页方法支持参数绑定</li>
<li class="calibre20">Query类的cache方法增加缓存标签参数</li>
<li class="calibre20">Query类的update和delete方法支持调用cache方法 会自动清除指定key的缓存 配合查询方法的cache方法一起使用 </li>
<li class="calibre20">改进Query类的延迟写入方法</li>
<li class="calibre20">Query类的column和value方法支持fetchsql</li>
<li class="calibre20">改进日期查询方法</li>
<li class="calibre20">改进存储过程方法exec的支持</li>
<li class="calibre20">改进Connection类的getLastInsID方法获取</li>
<li class="calibre20">记录数据库的连接日志（连接时间和DSN）</li>
<li class="calibre20">改进Query类的select方法的返回结果集判断  </li>
<li class="calibre20">Connection类增加getNumRows方法</li>
<li class="calibre20">数据库事务方法取消返回值</li>
<li class="calibre20">改进Query类的chunk方法对主键的获取</li>
<li class="calibre20">改进当数据库驱动类型使用完整命名空间的时候 Query类的builder方法的问题</li>
</ul><h3 id="%5B+%E6%A8%A1%E5%9E%8B+%5D" class="calibre17">[ 模型 ]</h3>
<ul class="calibre23"><li class="calibre20">增加软删除功能</li>
<li class="calibre20">关联模型和预载入改进</li>
<li class="calibre20">关联预载入查询闭包支持更多的连贯操作</li>
<li class="calibre20">完善savell方法支持更新和验证</li>
<li class="calibre20">关联定义统一返回Relation类</li>
<li class="calibre20">Model类的has和hasWhere方法对join类型的支持</li>
<li class="calibre20">Model类的data方法 批量赋值数据的时候 清空原始数据</li>
<li class="calibre20">Model类的get方法第三个参数传入true的时候会自动更新缓存</li>
<li class="calibre20">Model类增加只读字段支持</li>
<li class="calibre20">Model类增加useGlobalScope方法设置是否启用全局查询范围</li>
<li class="calibre20">Model类的base方法改为静态定义 全局多次调用有效</li>
<li class="calibre20">Model类支持设定主键、字段信息和字段类型，不依赖自动获取，提高性能</li>
<li class="calibre20">Model类的data方法 支持修改器</li>
<li class="calibre20">改进Relation类对非数字类型主键的支持</li>
<li class="calibre20">改进Relation类的一对多删除</li>
<li class="calibre20">修正Relation类的一对多关联预载入查询</li>
</ul><h3 id="%5B+%E6%97%A5%E5%BF%97%E5%92%8C%E7%BC%93%E5%AD%98+%5D" class="calibre17">[ 日志和缓存 ]</h3>
<ul class="calibre23"><li class="calibre20">支持日志类型分离存储</li>
<li class="calibre20">日志允许设置记录级别</li>
<li class="calibre20">增加缓存标签功能</li>
<li class="calibre20">缓存类增加pull方法用于获取并删除</li>
<li class="calibre20">cache助手函数增加tag参数</li>
<li class="calibre20">简化日志信息，隐藏数据库密码</li>
<li class="calibre20">增加cache/session redis驱动的库选择逻辑;</li>
<li class="calibre20">memcached驱动的配置参数支持option参数</li>
<li class="calibre20">调试模式下面 日志记录增加页面的header和param参数记录</li>
<li class="calibre20">memcached缓存驱动增加连接账号密码参数</li>
<li class="calibre20">缓存支持设置complex类型 支持配置多种缓存并用store切换</li>
<li class="calibre20">缓存类增加tag方法 用于缓存标签设置 clear方法支持清除某个缓存标签的数据</li>
<li class="calibre20">File类型日志驱动支持设置单独文件记录不同的日志级别</li>
<li class="calibre20">改进文件缓存和日志的存储文件名命名规范</li>
<li class="calibre20">缓存类增加inc和dec方法 针对数值型数据提供自增和自减操作</li>
<li class="calibre20">Cache类增加has方法 get方法支持默认值</li>
</ul><h3 id="%5B+%E5%85%B6%E5%AE%83+%5D-3" class="calibre17">[ 其它 ]</h3>
<ul class="calibre23"><li class="calibre20">视图类支持设置模板引擎参数</li>
<li class="calibre20">增加表单令牌生成和验证</li>
<li class="calibre20">增加中文验证规则</li>
<li class="calibre20">增加image和文件相关验证规则</li>
<li class="calibre20">重定向Response对象支持with方法隐含传参</li>
<li class="calibre20">改进Session类自动初始化</li>
<li class="calibre20">session类增加pull方法用于获取并删除</li>
<li class="calibre20">增加Env类用于获取环境变量</li>
<li class="calibre20">Request类get/post/put等更改赋值后param方法依然有效</li>
<li class="calibre20">改进Jump跳转地址支持Url::build 解析</li>
<li class="calibre20">优化Hook类</li>
<li class="calibre20">应用调试模式和页面trace支持环境变量设置</li>
<li class="calibre20">config助手函数支持 config('?name') 用法</li>
<li class="calibre20">支持使用BIND_MODULE常量的方式绑定模块</li>
<li class="calibre20">入口文件自动绑定模块功能</li>
<li class="calibre20">改进验证异常类的错误信息和模板输出，支持批量验证的错误信息抛出</li>
<li class="calibre20">完善console 增加output一些常用的方法</li>
<li class="calibre20">增加token助手函数 用于在页面快速显示令牌</li>
<li class="calibre20">增加halt方法用于变量调试并中断输出</li>
<li class="calibre20">改进Validate类的number验证规则 和 integer区分开</li>
<li class="calibre20">optimize:autoload增加对extend扩展目录的扫描</li>
<li class="calibre20">改进Validate类的boolean验证规则 支持表单数据</li>
<li class="calibre20">改进cookie助手函数支持 判断是否存在某个cookie值</li>
<li class="calibre20">改进abort助手函数 支持抛出HttpResponseException异常</li>
<li class="calibre20">改进File类增加对上传错误的处理</li>
<li class="calibre20">改进File类move方法的返回对象增加上传表单信息，增加获取文件散列值的方法</li>
<li class="calibre20">改进File类的move方法的返回对象改为返回File对象实例</li>
<li class="calibre20">增加clear和optimize:config 指令</li>
<li class="calibre20">改进File类和Validate类的图像文件类型验证</li>
<li class="calibre20">控制器的操作方法支持注入Request之外的对象实例</li>
<li class="calibre20">Request类 param(true) 支持获取带文件的数据</li>
<li class="calibre20">input助手函数第一个参数增加默认值</li>
<li class="calibre20">Validate类增加image验证规则 并改进max min length支持多种数据类型</li>
<li class="calibre20">json输出时数据编码失败后抛出异常</li>
</ul><h3 id="%5B+%E8%B0%83%E6%95%B4+%5D-1" class="calibre17">[ 调整 ]</h3>
<ul class="calibre23"><li class="calibre20">废除路由映射（静态路由）定义</li>
<li class="calibre20">取消url_deny_suffix配置 改由路由的deny_ext参数设置</li>
<li class="calibre20">模型save方法返回值改为影响的记录数，取消getId参数</li>
<li class="calibre20">Request对象controller方法返回驼峰控制器名</li>
<li class="calibre20">控制器前置操作方法不存在则抛出异常</li>
<li class="calibre20">Loader类db方法增加name标识参数</li>
<li class="calibre20">db助手函数增加第三个参数用于指定连接标识</li>
<li class="calibre20">Sqlsrv驱动默认不对数据表字段进行小写转换</li>
<li class="calibre20">移除sae驱动 改为扩展包</li>
<li class="calibre20">Oracle驱动移出核心包</li>
<li class="calibre20">Firebird驱动移出核心包</li>
<li class="calibre20">取消别名定义文件alias.php</li>
<li class="calibre20">配置参数读取的时候取消环境变量判断 需要读取环境变量的时候使用Env类</li>
<li class="calibre20">环境变量定义文件更改为 .env 由原来的PHP数组改为ini格式定义（支持数组方式）</li>
<li class="calibre20">状态配置和扩展配置的加载顺序调整 便于状态配置文件中可以更改扩展配置的参数</li>
<li class="calibre20">取消域名绑定到路由分组功能</li>
<li class="calibre20">控制器类的success和error方法url参数支持传入空字符串，则不做任何处理</li>
<li class="calibre20">控制器的error success result redirect方法均不需要使用return</li>
<li class="calibre20">创建目录的权限修改为0644</li>
</ul><h2 id="2016-7-1+rc4%E7%89%88%E6%9C%AC" class="calibre15">2016-7-1 RC4版本</h2>
<h3 id="%5B+%E5%BA%95%E5%B1%82%E6%9E%B6%E6%9E%84+%5D" class="calibre17">[ 底层架构 ]</h3>
<ul class="calibre23"><li class="calibre20">增加Request类 并支持自动注入</li>
<li class="calibre20">统一Composer的自动加载机制</li>
<li class="calibre20">增加Response类的子类扩展</li>
<li class="calibre20">增加File类用于上传和文件操作</li>
<li class="calibre20">取消模式扩展 SAE支持降权</li>
<li class="calibre20">优化框架入口文件</li>
<li class="calibre20">改进异常机制</li>
<li class="calibre20">App类输入/输出调整</li>
<li class="calibre20">单元测试的完美支持</li>
<li class="calibre20">增加新的控制台指令</li>
<li class="calibre20">取消系统路径之外的大部分常量定义</li>
<li class="calibre20">类库映射文件由命令行动态生成 包含应用类库</li>
</ul><h3 id="%5B+%E6%95%B0%E6%8D%AE%E5%BA%93+%5D-2" class="calibre17">[ 数据库 ]</h3>
<ul class="calibre23"><li class="calibre20">增加分表规则方法</li>
<li class="calibre20">增加日期和时间表达式查询方法</li>
<li class="calibre20">增加分页查询方法</li>
<li class="calibre20">增加视图查询方法</li>
<li class="calibre20">默认保持数据表字段大小写</li>
<li class="calibre20">数据缓存自动更新机制</li>
<li class="calibre20">完善事务嵌套支持</li>
<li class="calibre20">改进存储过程数据读取</li>
<li class="calibre20">支持设置数据库查询数据集返回类型</li>
</ul><h3 id="%5B+%E6%A8%A1%E5%9E%8B+%5D-1" class="calibre17">[ 模型 ]</h3>
<ul class="calibre23"><li class="calibre20">增加Merge扩展模型</li>
<li class="calibre20">模型支持动态查询</li>
<li class="calibre20">增加更多的类型自动转换支持</li>
<li class="calibre20">增加全局查询范围</li>
<li class="calibre20">toJson/toArray支持隐藏和增加属性输出</li>
<li class="calibre20">增加远程一对多关联</li>
</ul><h3 id="%5B+%E5%85%B6%E5%AE%83+%5D-4" class="calibre17">[ 其它 ]</h3>
<ul class="calibre23"><li class="calibre20">日志存储结构调整</li>
<li class="calibre20">Trace调试功能从日志类独立并增强</li>
<li class="calibre20">原Input类功能并入Request类</li>
<li class="calibre20">类库映射文件采用命令行生成 包含应用类库</li>
<li class="calibre20">验证类的check方法data数据取消引用传参</li>
<li class="calibre20">路由增加MISS路由规则</li>
<li class="calibre20">路由增加路由别名功能</li>
</ul><h2 id="2016-4-23+rc3%E7%89%88%E6%9C%AC" class="calibre15">2016-4-23 RC3版本</h2>
<h3 id="%5B+%E5%BA%95%E5%B1%82%E6%9E%B6%E6%9E%84+%5D-1" class="calibre17">[ 底层架构 ]</h3>
<ul class="calibre23"><li class="calibre20">框架核心仓库和应用仓库分离 便于composer独立更新</li>
<li class="calibre20">数据库类重构，拆分为Connection（连接器）/Query（查询器）/Builder（SQL生成器）</li>
<li class="calibre20">模型类重构，更加对象化</li>
</ul><h3 id="%5B+%E6%95%B0%E6%8D%AE%E5%BA%93+%5D-3" class="calibre17">[ 数据库 ]</h3>
<ul class="calibre23"><li class="calibre20">新的查询语法</li>
<li class="calibre20">闭包查询和闭包事务</li>
<li class="calibre20">Query对象查询</li>
<li class="calibre20">数据分批处理</li>
<li class="calibre20">数据库SQL执行监听</li>
</ul><h3 id="%5B+%E6%A8%A1%E5%9E%8B+%5D-2" class="calibre17">[ 模型 ]</h3>
<ul class="calibre23"><li class="calibre20">对象化操作</li>
<li class="calibre20">支持静态调用（查询）</li>
<li class="calibre20">支持读取器/修改器</li>
<li class="calibre20">时间戳字段</li>
<li class="calibre20">对象/数组访问</li>
<li class="calibre20">JSON序列化</li>
<li class="calibre20">事件触发</li>
<li class="calibre20">命名范围</li>
<li class="calibre20">类型自动转换</li>
<li class="calibre20">数据验证和完成</li>
<li class="calibre20">关联查询/写入</li>
<li class="calibre20">关联预载入</li>
</ul><h3 id="%5B+%E5%85%B6%E5%AE%83%E6%9B%B4%E6%96%B0+%5D" class="calibre17">[ 其它更新 ]</h3>
<ul class="calibre23"><li class="calibre20">路由类增加快速路由支持</li>
<li class="calibre20">验证Validate类重构</li>
<li class="calibre20">Build类增加快速创建模块的方法</li>
<li class="calibre20">Url生成类改进</li>
<li class="calibre20">Validate类改进</li>
<li class="calibre20">View类及模板引擎驱动设计改进</li>
<li class="calibre20">取消模板引擎的模板主题设计</li>
<li class="calibre20">修正社区反馈的一些问题</li>
<li class="calibre20">助手函数重新命名</li>
<li class="calibre20"><code class="calibre7">router.php</code>文件位置移动</li>
</ul><h2 id="2016-3-11+rc2%E7%89%88%E6%9C%AC" class="calibre15">2016-3-11 RC2版本</h2>
<ul class="calibre23"><li class="calibre20">重新设计的自动验证和自动完成机制（原有自动验证和完成支持采用traits\model\Auto兼容）；</li>
<li class="calibre20">验证类Validate独立设计；</li>
<li class="calibre20">自动生成功能交给Console完成；</li>
<li class="calibre20">对数据表字段大小写的处理；</li>
<li class="calibre20">改进Controller类（取消traits\contorller\View）；</li>
<li class="calibre20">改进Input类；</li>
<li class="calibre20">改进Url类；</li>
<li class="calibre20">改进Cookie类；</li>
<li class="calibre20">优化Loader类；</li>
<li class="calibre20">优化Route类；</li>
<li class="calibre20">优化Template类；</li>
<li class="calibre20">Session类自动初始化；</li>
<li class="calibre20">增加traits\model\Bulk模型扩展用于大批量数据写入和更新；</li>
<li class="calibre20">缓存类和日志类增加Test驱动；</li>
<li class="calibre20">对异常机制和错误处理的改进；</li>
<li class="calibre20">增加URL控制器和操作是否自动转换开关；</li>
<li class="calibre20">支持类名后缀设置；</li>
<li class="calibre20">取消操作绑定到类的功能；</li>
<li class="calibre20">取消use_db_switch参数设计；</li>
</ul><h2 id="2016-1-30+rc1%E7%89%88%E6%9C%AC" class="calibre15">2016-1-30 RC1版本</h2>
<h3 id="%5B+%E5%BA%95%E5%B1%82%E6%9E%B6%E6%9E%84+%5D-2" class="calibre17">[ 底层架构 ]</h3>
<ul class="calibre23"><li class="calibre20">真正的惰性加载</li>
<li class="calibre20">核心类库组件化</li>
<li class="calibre20">框架引导文件</li>
<li class="calibre20">完善的类库自动加载（支持Composer）</li>
<li class="calibre20">采用Traits扩展</li>
<li class="calibre20">API友好（输出、异常和调试）</li>
<li class="calibre20">文件命名规范调整</li>
</ul><h3 id="%5B+%E8%B0%83%E8%AF%95%E5%92%8C%E5%BC%82%E5%B8%B8+%5D" class="calibre17">[ 调试和异常 ]</h3>
<ul class="calibre23"><li class="calibre20">专为API开发而设计的输出、调试和异常处理</li>
<li class="calibre20">日志类支持本地文件/SAE/页面Trace/SocketLog输出，可以实现远程浏览器插件调试</li>
<li class="calibre20">内置trace方法直接远程调试</li>
<li class="calibre20">异常预警通知驱动设计</li>
<li class="calibre20">数据库SQL性能分析支持</li>
</ul><h3 id="%5B+%E8%B7%AF%E7%94%B1+%5D" class="calibre17">[ 路由 ]</h3>
<ul class="calibre23"><li class="calibre20">动态注册路由</li>
<li class="calibre20">自定义路由检测方法</li>
<li class="calibre20">路由分组功能</li>
<li class="calibre20">规则路由中的变量支持采用正则规则定义（包括全局和局部）</li>
<li class="calibre20">闭包路由</li>
<li class="calibre20">支持路由到多层控制器</li>
</ul><h3 id="%5B+%E6%8E%A7%E5%88%B6%E5%99%A8+%5D" class="calibre17">[ 控制器 ]</h3>
<ul class="calibre23"><li class="calibre20">控制器类无需继承controller类</li>
<li class="calibre20">灵活的多层控制器支持</li>
<li class="calibre20">可以Traits引入高级控制器功能</li>
<li class="calibre20">rest/yar/rpc/hprose/jsonrpc控制器扩展</li>
<li class="calibre20">前置操作方法支持排除和指定操作</li>
</ul><h3 id="%5B+%E6%A8%A1%E5%9E%8B+%5D-3" class="calibre17">[ 模型 ]</h3>
<ul class="calibre23"><li class="calibre20">简化的核心模型</li>
<li class="calibre20">Traits引入高级模型/视图模型/关联模型</li>
<li class="calibre20">主从分布时候主数据库读操作支持</li>
<li class="calibre20">改进的join方法和order方法</li>
</ul><h3 id="%5B+%E8%A7%86%E5%9B%BE+%5D" class="calibre17">[ 视图 ]</h3>
<ul class="calibre23"><li class="calibre20">视图解析驱动设计（模板引擎）</li>
<li class="calibre20">所有方法不再直接输出而是返回交由系统统一输出处理</li>
<li class="calibre20">动态切换模板主题设计</li>
<li class="calibre20">动态切换模板引擎设计</li>
</ul><h3 id="%5B+%E6%95%B0%E6%8D%AE%E5%BA%93+%5D-4" class="calibre17">[ 数据库 ]</h3>
<ul class="calibre23"><li class="calibre20">完全基于PDO实现</li>
<li class="calibre20">简化的数据库驱动设计</li>
<li class="calibre20">SQL性能监控（需要开启数据库调试模式）</li>
<li class="calibre20">PDO参数绑定改进</li>
</ul><h3 id="%5B+%E5%85%B6%E4%BB%96%E6%96%B9%E9%9D%A2+%5D" class="calibre17">[ 其他方面 ]</h3>
<ul class="calibre23"><li class="calibre20">目录和MVC文件自动生成支持</li>
<li class="calibre20">I函数默认添加变量修饰符为/s</li>
<li class="calibre20">一个行为类里面支持为多个标签位定义不同的方法</li>
<li class="calibre20">更多的社交扩展类库</li>
</ul></div>
	
</body></html>
