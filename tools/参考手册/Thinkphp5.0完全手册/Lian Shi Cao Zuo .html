<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
  <head>
    <title>链式操作</title>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
        <h1 class="book-title" id="calibre_toc_78">链式操作</h1>
<div class="book-content">
    <p class="calibre10">数据库提供的链式操作方法，可以有效的提高数据存取的代码清晰度和开发效率，并且支持所有的CURD操作。</p>
<p class="calibre10">使用也比较简单，假如我们现在要查询一个User表的满足状态为1的前10条记录，并希望按照用户的创建时间排序 ，代码如下：</p>
<pre class="calibre21"><code class="calibre22">Db::table('think_user')
    -&gt;where('status',1)
    -&gt;order('create_time')
    -&gt;limit(10)
    -&gt;select();</code></pre>
<p class="calibre10">这里的<code class="calibre7">where</code>、<code class="calibre7">order</code>和<code class="calibre7">limit</code>方法就被称之为链式操作方法，除了select方法必须放到最后一个外（因为select方法并不是链式操作方法），链式操作的方法调用顺序没有先后，例如，下面的代码和上面的等效：</p>
<pre class="calibre21"><code class="calibre22">Db::table('think_user')
    -&gt;order('create_time')
    -&gt;limit(10)
    -&gt;where('status',1)
    -&gt;select();</code></pre>
<p class="calibre10">其实不仅仅是查询方法可以使用连贯操作，包括所有的CURD方法都可以使用，例如：</p>
<pre class="calibre21"><code class="calibre22">Db::table('think_user')
    -&gt;where('id',1)
    -&gt;field('id,name,email')
    -&gt;find(); 
Db::table('think_user')
    -&gt;where('status',1)
    -&gt;where('id',1)
    -&gt;delete();</code></pre>
<p class="calibre10">链式操作在完成查询后会自动清空链式操作的所有传值。简而言之，链式操作的结果不会带入后面的其它查询。</p>
<p class="calibre10">系统支持的链式操作方法有： </p>
<table class="calibre25"><thead class="calibre26"><tr class="calibre27"><th class="calibre28">连贯操作</th>
<th class="calibre28">作用</th>
<th class="calibre28">支持的参数类型</th>
</tr></thead><tbody class="calibre29"><tr class="calibre27"><td class="pcalibre1 calibre30">where*</td>
<td class="pcalibre1 calibre31">用于AND查询</td>
<td class="calibre32 pcalibre1">字符串、数组和对象</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">whereOr*</td>
<td class="pcalibre1 calibre31">用于OR查询</td>
<td class="pcalibre1 calibre31">字符串、数组和对象</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">wheretime*</td>
<td class="pcalibre1 calibre31">用于时间日期的快捷查询</td>
<td class="pcalibre1 calibre31">字符串</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">table</td>
<td class="pcalibre1 calibre31">用于定义要操作的数据表名称</td>
<td class="pcalibre1 calibre31">字符串和数组</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">alias</td>
<td class="pcalibre1 calibre31">用于给当前数据表定义别名</td>
<td class="pcalibre1 calibre31">字符串</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">field*</td>
<td class="pcalibre1 calibre31">用于定义要查询的字段（支持字段排除）</td>
<td class="pcalibre1 calibre31">字符串和数组</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">order</td>
<td class="pcalibre1 calibre31">用于对结果排序</td>
<td class="pcalibre1 calibre31">字符串和数组</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">limit</td>
<td class="pcalibre1 calibre31">用于限制查询结果数量</td>
<td class="pcalibre1 calibre31">字符串和数字</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">page</td>
<td class="pcalibre1 calibre31">用于查询分页（内部会转换成limit）</td>
<td class="pcalibre1 calibre31">字符串和数字</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">group</td>
<td class="pcalibre1 calibre31">用于对查询的group支持</td>
<td class="pcalibre1 calibre31">字符串</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">having</td>
<td class="pcalibre1 calibre31">用于对查询的having支持</td>
<td class="pcalibre1 calibre31">字符串</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">join*</td>
<td class="pcalibre1 calibre31">用于对查询的join支持</td>
<td class="pcalibre1 calibre31">字符串和数组</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">union*</td>
<td class="pcalibre1 calibre31">用于对查询的union支持</td>
<td class="pcalibre1 calibre31">字符串、数组和对象</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">view</td>
<td class="pcalibre1 calibre31">用于视图查询</td>
<td class="pcalibre1 calibre31">字符串、数组</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">distinct</td>
<td class="pcalibre1 calibre31">用于查询的distinct支持</td>
<td class="pcalibre1 calibre31">布尔值</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">lock</td>
<td class="pcalibre1 calibre31">用于数据库的锁机制</td>
<td class="pcalibre1 calibre31">布尔值</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">cache</td>
<td class="pcalibre1 calibre31">用于查询缓存</td>
<td class="pcalibre1 calibre31">支持多个参数</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">relation</td>
<td class="pcalibre1 calibre31">用于关联查询</td>
<td class="pcalibre1 calibre31">字符串</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">with</td>
<td class="pcalibre1 calibre31">用于关联预载入</td>
<td class="pcalibre1 calibre31">字符串、数组</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">bind*</td>
<td class="pcalibre1 calibre31">用于数据绑定操作</td>
<td class="pcalibre1 calibre31">数组或多个参数</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">comment</td>
<td class="pcalibre1 calibre31">用于SQL注释</td>
<td class="pcalibre1 calibre31">字符串</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">force</td>
<td class="pcalibre1 calibre31">用于数据集的强制索引</td>
<td class="pcalibre1 calibre31">字符串</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">master</td>
<td class="pcalibre1 calibre31">用于设置主服务器读取数据</td>
<td class="pcalibre1 calibre31">布尔值</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">strict</td>
<td class="pcalibre1 calibre31">用于设置是否严格检测字段名是否存在</td>
<td class="pcalibre1 calibre31">布尔值</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">sequence</td>
<td class="pcalibre1 calibre31">用于设置Pgsql的自增序列名</td>
<td class="pcalibre1 calibre31">字符串</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">failException</td>
<td class="pcalibre1 calibre31">用于设置没有查询到数据是否抛出异常</td>
<td class="pcalibre1 calibre31">布尔值</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">partition</td>
<td class="pcalibre1 calibre31">用于设置分表信息</td>
<td class="calibre33 pcalibre1">数组 字符串</td>
</tr></tbody></table><blockquote class="calibre5">
<p class="calibre14">所有的连贯操作都返回当前的模型实例对象（this），其中带*标识的表示支持多次调用。</p>
</blockquote>
</div>
	
</body></html>
