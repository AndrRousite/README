<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
  <head>
    <title>JSON序列化</title>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
        <h1 class="book-title" id="calibre_toc_109">JSON序列化</h1>
<div class="book-content">
    <table class="calibre25"><thead class="calibre26"><tr class="calibre27"><th class="calibre28">版本</th>
<th class="calibre28">新增功能</th>
</tr></thead><tbody class="calibre29"><tr class="calibre27"><td class="pcalibre1 calibre30">5.0.5</td>
<td class="calibre32 pcalibre1"><code class="calibre7">hidden</code>、<code class="calibre7">visible</code>和<code class="calibre7">append</code>方法支持关联属性</td>
</tr><tr class="calibre27"><td class="pcalibre1 calibre31">5.0.4</td>
<td class="calibre33 pcalibre1">增加<code class="calibre7">appendRelationAttr</code>方法追加关联模型的属性</td>
</tr></tbody></table><p class="calibre10">可以调用模型的<code class="calibre7">toJson</code>方法进行<code class="calibre7">JSON</code>序列化</p>
<pre class="calibre21"><code class="calibre22">$user = User::get(1);
echo $user-&gt;toJson();</code></pre>
<p class="calibre10">可以设置无需输出的字段，例如：</p>
<pre class="calibre21"><code class="calibre22">$user = User::get(1);
echo $user-&gt;hidden(['create_time','update_time'])-&gt;toJson();</code></pre>
<p class="calibre10">或者追加其它的字段：</p>
<pre class="calibre21"><code class="calibre22">$user = User::get(1);
echo $user-&gt;append(['status_text'])-&gt;toJson();</code></pre>
<p class="calibre10">设置允许输出的属性：</p>
<pre class="calibre21"><code class="calibre22">$user = User::get(1);
echo $user-&gt;visible(['id','name','email'])-&gt;toJson();</code></pre>
<p class="calibre10">模型对象可以直接被JSON序列化，例如：</p>
<pre class="calibre21"><code class="calibre22">echo json_encode(User::get(1));</code></pre>
<p class="calibre10">输出结果类似于：</p>
<pre class="calibre21"><code class="calibre22">{"id":"1","name":"","title":"","status":"1","update_time":"1430409600","score":"90.5"}</code></pre>
<p class="calibre10">或者也可以直接<code class="calibre7">echo</code> 一个模型对象，例如：</p>
<pre class="calibre21"><code class="calibre22">echo User::get(1);</code></pre>
<p class="calibre10">输出的结果和上面是一样的。</p>
<h2 id="%E8%BF%BD%E5%8A%A0%E5%85%B3%E8%81%94%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B1%9E%E6%80%A7%EF%BC%88v5.0.4%2B%EF%BC%89" class="calibre15">追加关联模型的属性（V5.0.4+）</h2>
<p class="calibre10"><code class="calibre7">V5.0.4+</code>版本开始，支持追加一对一关联模型的属性到当前模型，例如：</p>
<pre class="calibre21"><code class="calibre22">$user = User::find(1);
echo $user-&gt;appendRelationAttr('profile',['email','nickname'])-&gt;toJson();</code></pre>
<p class="calibre10"><code class="calibre7">profile</code>是关联定义方法名，<code class="calibre7">email</code>和<code class="calibre7">nickname</code>是<code class="calibre7">Profile</code>模型的属性。</p>
</div>
	
</body></html>
