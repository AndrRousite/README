<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
  <head>
    <title>模型验证</title>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
        <h1 class="book-title" id="calibre_toc_174">模型验证</h1>
<div class="book-content">
    <p class="calibre10">在模型中的验证方式如下：</p>
<pre class="calibre21"><code class="calibre22">$User = new User;
$result = $User-&gt;validate(
    [
        'name'  =&gt; 'require|max:25',
        'email'   =&gt; 'email',
    ],
    [
        'name.require' =&gt; '名称必须',
        'name.max'     =&gt; '名称最多不能超过25个字符',
        'email'        =&gt; '邮箱格式错误',
    ]
)-&gt;save($data);
if(false === $result){
    // 验证失败 输出错误信息
    dump($User-&gt;getError());
}</code></pre>
<blockquote class="calibre5">
<p class="calibre14">第二个参数如果不传的话，则采用默认的错误提示信息。</p>
</blockquote>
<p class="calibre10">如果使用下面的验证器类的话：</p>
<pre class="calibre21"><code class="calibre22">namespace app\index\validate;
use think\Validate;
class User extends Validate
{
    protected $rule = [
        'name'  =&gt;  'require|max:25',
        'email' =&gt;  'email',
    ];

    protected $message = [
        'name.require'  =&gt;  '用户名必须',
        'email' =&gt;  '邮箱格式错误',
    ];

    protected $scene = [
        'add'   =&gt;  ['name','email'],
        'edit'  =&gt;  ['email'],
    ];    
}</code></pre>
<p class="calibre10">模型验证代码可以简化为：</p>
<pre class="calibre21"><code class="calibre22">$User = new User;
// 调用当前模型对应的User验证器类进行数据验证
$result = $User-&gt;validate(true)-&gt;save($data);
if(false === $result){
    // 验证失败 输出错误信息
    dump($User-&gt;getError());
}</code></pre>
<p class="calibre10">如果需要调用的验证器类和当前的模型名称不一致，则可以使用：</p>
<pre class="calibre21"><code class="calibre22">$User = new User;
// 调用Member验证器类进行数据验证
$result = $User-&gt;validate('Member')-&gt;save($data);
if(false === $result){
    // 验证失败 输出错误信息
    dump($User-&gt;getError());
}</code></pre>
<p class="calibre10">同样也可以支持场景验证：</p>
<pre class="calibre21"><code class="calibre22">$User = new User;
// 调用Member验证器类进行数据验证
$result = $User-&gt;validate('User.edit')-&gt;save($data);
if(false === $result){
    // 验证失败 输出错误信息
    dump($User-&gt;getError());
}</code></pre>
</div>
	
</body></html>
