<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
  <head>
    <title>验证码</title>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
        <h1 class="book-title" id="calibre_toc_190">验证码</h1>
<div class="book-content">
    <p class="calibre10">首先使用<code class="calibre7">Composer</code>安装<code class="calibre7">think-captcha</code>扩展包：</p>
<pre class="calibre21"><code class="calibre22">composer require topthink/think-captcha</code></pre>
<h2 id="%E9%AA%8C%E8%AF%81%E7%A0%81%E9%85%8D%E7%BD%AE" class="calibre15">验证码配置</h2>
<p class="calibre10">然后在应用配置文件中添加验证码的配置参数</p>
<pre class="calibre21"><code class="calibre22">'captcha'  =&gt; [
        // 验证码字符集合
        'codeSet'  =&gt; '2345678abcdefhijkmnpqrstuvwxyzABCDEFGHJKLMNPQRTUVWXY', 
        // 验证码字体大小(px)
        'fontSize' =&gt; 25, 
        // 是否画混淆曲线
        'useCurve' =&gt; true, 
         // 验证码图片高度
        'imageH'   =&gt; 30,
        // 验证码图片宽度
        'imageW'   =&gt; 100, 
        // 验证码位数
        'length'   =&gt; 5, 
        // 验证成功后是否重置        
        'reset'    =&gt; true
],</code></pre>
<p class="calibre10">并且确保开启了URL路由。</p>
<h2 id="%E9%AA%8C%E8%AF%81%E7%A0%81%E6%98%BE%E7%A4%BA" class="calibre15">验证码显示</h2>
<pre class="calibre21"><code class="calibre22">&lt;div&gt;{:captcha_img()}&lt;/div&gt;</code></pre>
<p class="calibre10">或者</p>
<pre class="calibre21"><code class="calibre22">&lt;div&gt;&lt;img src="{:captcha_src()}" alt="captcha" /&gt;&lt;/div&gt;</code></pre>
<blockquote class="info">
<p class="calibre14">上面两种的最终效果是一样的，根据需要调用即可。</p>
</blockquote>
<h2 id="%E6%8E%A7%E5%88%B6%E5%99%A8%E9%AA%8C%E8%AF%81" class="calibre15">控制器验证</h2>
<p class="calibre10">使用TP5的内置验证功能，添加<code class="calibre7">captcha</code>验证规则即可</p>
<pre class="calibre21"><code class="calibre22">$this-&gt;validate($data,[
    'captcha|验证码'=&gt;'require|captcha'
]);</code></pre>
<p class="calibre10">或者手动验证</p>
<pre class="calibre21"><code class="calibre22">if(!captcha_check($captcha)){
 //验证失败
};</code></pre>
</div>
	
</body></html>
